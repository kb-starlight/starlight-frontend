<template>
  <div class="header">
    <h3>오늘의 사연랭킹</h3>
  </div>
  <div class="banner" id="banner">
    <div class="cards-container">
            <a class="href" href="http://localhost:8080/Detailstory/%EC%84%A4%EC%9D%84%20%EB%A7%9E%EC%95%84%20%ED%95%A8%EA%BB%98%20%EB%A7%8C%EB%93%A0%20%EC%9D%B8%EC%A0%88%EB%AF%B8/%ED%95%A8%EA%BB%98%20%EB%A7%8C%EB%93%A0%20%EC%9D%B8%EC%A0%88%EB%AF%B8%EB%A1%9C%20%EC%A0%84%EB%8B%AC%ED%95%98%EB%8A%94%20%EB%94%B0%EC%8A%A4%ED%95%9C%20%EB%A7%88%EC%9D%8C.%20%EA%B3%A0%EC%95%84%EC%9B%90%EC%97%90%EB%8F%84%201%EB%85%84%EC%97%90%20%ED%95%9C%20%EB%B2%88%EC%94%A9%20%EC%B6%95%EC%A0%9C%EA%B0%80%20%EC%97%B4%EB%A6%BD%EB%8B%88%EB%8B%A4.%20%EB%B0%94%EB%A1%9C%20%EC%9D%B8%EC%A0%88%EB%AF%B8%20%EB%A7%8C%EB%93%9C%EB%8A%94%20%EB%82%A0%EC%9E%85%EB%8B%88%EB%8B%A4.%20%EC%95%84%EC%9D%B4%EB%93%A4%EC%9D%B4%20%ED%95%A8%EA%BB%98%20%EC%A7%81%EC%A0%91%20%EB%A7%8C%EB%93%A0%20%EC%9D%B8%EC%A0%88%EB%AF%B8%EB%A5%BC%20%EB%82%98%EB%88%A0%EB%A8%B9%EC%9C%BC%EB%A9%B0%20%EC%9B%83%EA%B3%A0%20%EC%9E%88%EC%8A%B5%EB%8B%88%EB%8B%A4.%20%EC%98%88%EC%A7%80%EB%8A%94%20%EC%98%A4%EB%9E%9C%EB%A7%8C%EC%97%90%20%EC%9D%B8%EC%A0%88%EB%AF%B8%EB%A5%BC%20%EB%A8%B9%EC%96%B4%20%EA%B8%B0%EB%B6%84%EC%9D%B4%20%EC%A2%8B%EC%8A%B5%EB%8B%88%EB%8B%A4.%20%EB%8B%B9%EC%8B%A0%EC%9D%98%20%EB%94%B0%EB%9C%BB%ED%95%9C%20%EB%82%98%EB%88%94%EC%9C%BC%EB%A1%9C%20%EC%95%84%EC%9D%B4%EB%93%A4%EC%9D%98%20%EC%9B%83%EC%9D%8C%EC%9D%84%20%EC%A7%80%EC%BC%9C%EC%A3%BC%EC%84%B8%EC%9A%94./2024-04-25T07:05:11.000Z/110/10000">
              <preview-card
              image="https://happybean-phinf.pstatic.net/20240409_243/1712656139366lY24E_PNG/4.%25A1%25E1%25BC%25E1%25A9%25E1%25A8%25E1%25A5%25E1.png?type=a360"
              label="설을 맞아 함께 만든 인절미"
              description=" 함께 만든 인절미로 전달하는 따스한 마음을 함께 나눠요"
            /></a>
            <a class="href" href="http://localhost:8080/Detailstory/%EC%9B%90%EC%9E%A5%EB%8B%98%EA%BB%98%20%EC%A0%84%ED%95%98%EB%8A%94%20%EA%B0%90%EC%82%AC%EC%9D%98%20%EB%A7%88%EC%9D%8C/%EC%8A%A4%EC%8A%B9%EC%9D%98%20%EB%82%A0%EC%9D%84%20%EB%A7%9E%EC%95%84%20%EC%B9%B4%EB%84%A4%EC%9D%B4%EC%85%98%EC%9D%84%20%EB%8B%AC%EC%95%84%EB%93%9C%EB%A6%AC%EA%B3%A0%20%EC%8B%B6%EC%97%88%EC%96%B4%EC%9A%94.%20%0A%EC%84%B1%EC%9D%80%EC%9D%B4%EB%8A%94%20%EC%98%A4%EB%8A%98%EB%8F%84%20%EC%82%B0%EC%9D%84%20%EB%92%A4%EC%A7%91%EB%8B%88%EB%8B%A4.%20%EC%B9%B4%EB%84%A4%EC%9D%B4%EC%85%98%EC%9D%84%20%EC%B0%BE%EA%B8%B0%20%EC%9C%84%ED%95%B4%EC%84%9C%EC%9D%B4%EC%A3%A0...%20%0A%ED%82%A4%EC%9B%8C%EC%A3%BC%EC%8B%9C%EB%8A%94%20%EA%B3%A0%EC%95%84%EC%9B%90%20%EC%9B%90%EC%9E%A5%EB%8B%98%EA%BB%98%20%EA%B0%90%EC%82%AC%EC%9D%98%20%EB%A7%88%EC%9D%8C%EC%9D%84%20%EC%A0%84%ED%95%98%EA%B3%A0%20%EC%8B%B6%EC%8A%B5%EB%8B%88%EB%8B%A4./2024-04-25T06:11:17.000Z/107/10000">
            <preview-card
              image="https://happybean-phinf.pstatic.net/20240409_84/1712656161293toLYm_PNG/5.%25A6%25E1%25AB%25E1%25A6%25E1%25B3%25E1%25A6%25E1%25B5%25E1%25B3%25E1.png?type=a360"
              label="원장님께 전하는 감사의 마음"
              description="스승의 날을 맞아 카네이션을 달아드리고 싶었어요"
            />
            </a>
            <a class="href" href="http://localhost:8080/Detailstory/%EC%8B%9C%EA%B0%81%20%EC%9E%A5%EC%95%A0%EC%9D%B8%EB%93%A4%EC%9D%B4%20%EB%A7%8C%EB%93%A0%20%EA%B0%80%EB%B0%A9/%EC%A1%B0%EA%B8%88%20%EB%8A%90%EB%A6%AC%EB%8D%94%EB%9D%BC%EB%8F%84,%20%EC%A7%81%EC%A0%91%20%EB%A7%8C%EB%93%A0%20%EB%9D%BC%ED%83%84%20%EA%B0%80%EB%B0%A9.%20%EC%8A%A4%ED%83%80%EB%9D%BC%EC%9D%B4%ED%8A%B8%20%EA%B0%80%EB%B0%A9%EA%B3%BC%20%ED%95%A8%EA%BB%98%20%EC%82%AC%EB%9E%91%EC%9D%98%20%EC%8B%A4%EC%B2%9C%20%ED%95%A8%EA%BB%98%ED%95%B4%EC%9A%94%0A%EC%8B%9C%EA%B0%81%20%EC%9E%A5%EC%95%A0%EC%9D%B8%20%EC%9D%BC%EC%9E%90%EB%A6%AC%20%EC%A7%80%EC%9B%90%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8%EC%9C%BC%EB%A1%9C%20%EC%A7%84%ED%96%89%EB%90%98%EB%8A%94%20%EC%8A%A4%ED%83%80%EB%9D%BC%EC%9D%B4%ED%8A%B8%20%EA%B0%80%EB%B0%A9.%20%0A%EC%A1%B0%EA%B8%88%20%EC%84%9C%ED%88%B4%EB%8D%94%EB%9D%BC%EB%8F%84%20%ED%95%A8%EA%BB%98%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94.%0A%EC%88%98%EC%9D%B5%EA%B8%88%EC%9D%80%20%EC%A0%84%EC%95%A1%20%EC%8B%9C%EA%B0%81%EC%9E%A5%EC%95%A0%EC%9D%B8%20%EB%B3%B4%ED%98%B8%EC%9E%AC%EB%8B%A8%20%EB%85%B8%EB%9E%80%ED%8E%84%EC%9D%B4%EC%97%90%20%EA%B8%B0%EB%B6%80%EB%90%A9%EB%8B%88%EB%8B%A4./2024-04-25T06:14:22.000Z/108/10000">
            <preview-card
              image="https://happybean-phinf.pstatic.net/20240409_242/1712656181657O4qMe_PNG/6.%25A6%25E1%25A5%25E1%25B3%25E1%25A6%25E1%25B5%25E1%25B3%25E1%25A9%25E1%25B5%25E1%25A1%25E1%25B3%25E1.png?type=a360"
              label="시각 장애인들이 만든 가방"
              description="조금 느리더라도, 직접 만든 라탄 가방. 스타라이트 가방과 함께 사랑의 실천 함께해요"
            />
            </a>
            <a class="href" href="http://localhost:8080/Detailstory/%EC%9A%94%EB%A6%AC%EC%82%AC%EA%B0%80%20%EB%90%98%EA%B3%A0%EC%8B%B6%EC%9D%80%20%EC%84%B8%EC%95%99%EC%9D%B4/%EC%9A%94%EB%A6%AC%EC%82%AC%EA%B0%80%20%EA%BF%88%EC%9D%B4%EC%97%88%EB%8D%98%20%EC%84%B8%EC%95%99%EC%9D%B4.%20%EA%BF%88%EB%B3%B4%EB%8B%A8%20%ED%98%84%EC%8B%A4%EC%9D%B4%20%EA%B0%80%EA%B9%9D%EA%B8%B0%EC%97%90%20%EC%98%A4%EB%8A%98%EB%8F%84%20%ED%98%84%EC%8B%A4%EC%9D%84%20%EC%82%B4%EC%95%84%EA%B0%80%EA%B3%A0%20%EC%9E%88%EC%8A%B5%EB%8B%88%EB%8B%A4.%20%EC%95%84%ED%94%88%20%EB%8F%99%EC%83%9D%EC%9D%84%20%EB%8F%8C%EB%B3%B4%EA%B8%B0%20%EC%9C%84%ED%95%B4%20%EA%BF%88%EC%9D%80%20%EC%BB%A4%EB%85%95%20%ED%95%99%EA%B5%90%20%EB%8B%A4%EB%8B%88%EA%B8%B0%EB%8F%84%20%EB%B2%85%EC%B0%AC%20%EC%84%B8%EC%95%99%EC%9D%B4%EC%9D%98%20%EA%BF%88%EC%9D%84%20%EC%9D%B4%EB%A4%84%EC%A3%BC%EC%84%B8%EC%9A%94.%20/2024-04-25T06:17:08.000Z/109/10000">
            <preview-card
              image="https://happybean-phinf.pstatic.net/20240409_239/1712656062181JJiqi_PNG/9.%25A1%25E1%25AC%25E1%25A9%25E1.png?type=a360"
              label="요리사가 되고싶은 세앙이"
              description="세앙이의 꿈을 이뤄주세요. 여러분의 손길이 한 아이의 인생을 바꿀 수 있습니다."
            /></a>
          </div>
  </div>
  <div class="contents">
    <h3>진행중인 사연</h3>
  </div>
  <div class="write-button">
    <button
      style="
        border: none;
        background-color: #41c982;
        padding: 10px 20px;
        border-radius: 10px;
        color: white;
      "
      @click="write()"
    >
      사연 작성하기
    </button>
  </div>
  <br /><br />
  <div class="content-layout">
  <div v-for="(chunk, index) in chunkedPosts" :key="index" class="cards-container">
    <div v-for="post in chunk" :key="post.post_no" class="card" @click="goToDetail(post)"><br>
      <div class="card-title">{{ post.title }}</div><br>
      <div class="card-title">작성자 : {{ post.name }}</div><br>
      <!-- 여기에 게시물 번호 표시 -->
      <div class="post-number">{{ post.post_no }}</div>
    </div>
  </div>
</div>
</template>
<script>
import PreviewCard from "@/components/PreviewCard.vue";
import axios from "axios";
export default {
  name: "StoryPage",
  computed: {
    chunkedPosts() {
      const chunkSize = 4;
      const chunks = [];
      for (let i = 0; i < this.posts.length; i += chunkSize) {
        chunks.push(this.posts.slice(i, i + chunkSize));
      }
      return chunks;
    },
  },
  mounted() {
    this.fetchPosts();
  },
  data() {
    return {
      posts: [],
      memberNo: 1,
    };
  },
  setup() {
    return {};
  },
  components: {
    PreviewCard,
  },
  methods: {
    goToDetail(post) {
      this.$router.push({ name: 'Detailstory', params: { title: post.title, content: post.content, sendtime: post.sendtime, post_no: post.post_no, member_no : post.member_no }});
    },
    write() {
      if(this.$store.getters.getUserInfo[0]){
        this.$router.push("/Newstory");
      }else{
        alert('게시글 작성을 위해 로그인을 진행해주세요.')
      }
    },
    open(a){
      let url = "http://localhost:3000/viewPost?post_no=" + a;
      axios.get(url).then((res) => {
        console.log(res.data);
        if (res.data.state == "none") {
          alert("게시물을 오픈할 수 없습니다.");
        } else {
          alert('정보가 들어옴')
          console.log(res.data.info);
          this.post = res.data.info;
          console.log(this.post);
        }
      });
    },

    fetchPosts() {
      let url = "http://localhost:3000/fetchPosts?board_no=" + this.memberNo;
      axios
        .get(url)
        .then((response) => {
          if (response.data.state === "ok") {
            this.posts = response.data.info;
          } else {
            console.log(response.data.message);
          }
        })
    },
  }
};
</script>
<style scoped>
.content-layout {
  overflow: auto;
}
.header {
  text-align: center;
  padding: 20px;
}
.banner {
  margin: 0px;
  padding: 50px;
  background-color: #efefef;
}
.contents {
  text-align: center;
  margin-top: 70px;
}
h3 {
  font-size: 25px;
  font-weight: 900;
  line-height: 1.2;
}
.cards-container {
  display: flex;
  justify-content: center;
  gap: 30px;
  margin-bottom: 30px;
}
.write-button {
  text-align: right;
  margin-right: 180px;
}
/* 버튼 클릭 효과 */
.write-button button:active {
  transform: translateY(2px); /* 클릭되었을 때 버튼을 아래로 이동 */
  box-shadow: 0 5px 5px rgba(0, 0, 0, 0.1); /* 클릭되었을 때 약간의 그림자 효과 추가 */
}
/* 카드 스타일 설정 */
.card {
  background-color: #ffffff;
  border: 1px solid #dddddd;
  border-radius: 10px;
  padding: 20px;
  width: 300px;
  height: 200px;
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
  margin-bottom: 20px;

  cursor: pointer;
}
.card-title {
  font-size: 20px;
  font-weight: bold;
  margin-bottom: 10px;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
.card-body {
  font-size: 16px;
  line-height: 1.5;
  color: #333333;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
.post-number {
  font-size: 14px;
  color: #888888;
}

.card-title:hover,
.card-body:hover {
  white-space: normal;
  text-overflow: unset;
  overflow: unset;
  z-index: 1;
  position: relative;
}
.href{
  text-decoration: none;
}
</style>
